import{a as G}from"./chunk-4JKD2TZL.js";import{a as ae}from"./chunk-BYU4ZZDF.js";import{c as J}from"./chunk-R2BWZGB6.js";import{a as K,b as Z,c as ee,d as ie}from"./chunk-GPMS4MJC.js";import{a as te}from"./chunk-KSL4GJU4.js";import{a as W}from"./chunk-PSDVRDZ2.js";import{a as Q}from"./chunk-2DCUL4N3.js";import{a as Y}from"./chunk-A6I5M2ZJ.js";import{a as X}from"./chunk-TXDXGVCW.js";import"./chunk-SGYCFQGT.js";import"./chunk-LTCMITUI.js";import{a as O}from"./chunk-ZAWSE2MG.js";import"./chunk-F6IFWQ6I.js";import"./chunk-PUI4IBEA.js";import"./chunk-J6MKEWI4.js";import{a as ue}from"./chunk-MEC76M2Q.js";import"./chunk-3CD6P3UR.js";import{Cb as R,Da as T,Fb as j,Gb as U,Ha as C,Ia as w,Ja as M,Ka as F,La as s,Ma as r,Na as h,P as v,Pb as L,Qa as y,Ra as x,Rb as q,Sb as z,Va as A,Xb as V,Yb as H,bb as p,cb as l,e as ve,f as D,jb as N,ka as g,la as o,lb as a,mb as n,o as f,pa as S,t as b,ta as E,za as $}from"./chunk-FKC2K5KC.js";var oe=ve(ue());var fe=()=>({position:"relative"});function Te(d,m){if(d&1&&(h(0,"img",8),a(1,"pokemonShinyPath")),d&2){let e=x().$implicit;T("src",n(1,1,e.baseData.image_shiny),g)}}function he(d,m){if(d&1&&(h(0,"img",8),a(1,"pokemonPath")),d&2){let e=x().$implicit;T("src",n(1,1,e.baseData.image),g)}}function ke(d,m){if(d&1&&(s(0,"div",5)(1,"div",0)(2,"div",7),$(3,Te,2,3,"img",8)(4,he,2,3,"img",8),s(5,"div",9)(6,"span"),p(7),a(8,"translate"),a(9,"titlecase"),r(),h(10,"img",10),a(11,"typePath"),r()(),s(12,"div",11)(13,"div",12)(14,"small"),p(15),a(16,"translate"),r(),s(17,"select",13)(18,"option",14),p(19),a(20,"translate"),a(21,"titlecase"),r()()(),s(22,"div",12)(23,"small"),p(24),a(25,"translate"),r(),s(26,"select",15)(27,"option",14),p(28),a(29,"translate"),a(30,"titlecase"),r()()()(),s(31,"div",16)(32,"div",0)(33,"div",17)(34,"div",12)(35,"small"),p(36),a(37,"translate"),r(),s(38,"select",18)(39,"option",14),p(40),a(41,"translate"),a(42,"titlecase"),r()()()(),s(43,"div",17)(44,"div",12)(45,"small"),p(46),a(47,"translate"),r(),s(48,"select",19)(49,"option",14),p(50),a(51,"translate"),a(52,"titlecase"),r()()()(),s(53,"div",17)(54,"div",12)(55,"small"),p(56),a(57,"translate"),r(),s(58,"select",20)(59,"option",14),p(60),a(61,"translate"),a(62,"titlecase"),r()()()(),s(63,"div",17)(64,"div",12)(65,"small"),p(66),a(67,"translate"),r(),s(68,"select",20)(69,"option",14),p(70),a(71,"translate"),a(72,"titlecase"),r()()()()()()(),h(73,"a",21),r()),d&2){let e=m.$implicit,t=x();T("ngStyle",N(61,fe)),o(3),C(e.teamInfo.is_shiny?3:4),o(4),l(n(9,21,n(8,19,`pokemonData.name.${e.baseData.id}`))),o(3),T("src",n(11,23,e.teraTypeImage),g),o(5),l(n(16,25,"teamBuilder.ability")),o(4),l(n(21,29,n(20,27,`abilities.name.${e.teamInfo.ability}`))),o(5),l(n(25,31,"teamBuilder.item")),o(4),l(n(30,35,n(29,33,`items.name.${e.teamInfo.item}`))),o(8),l(n(37,37,"teamBuilder.move1")),o(4),l(n(42,41,n(41,39,`moves.name.${e.teamInfo.move_1}`))),o(6),l(n(47,43,"teamBuilder.move2")),o(4),l(n(52,47,n(51,45,`moves.name.${e.teamInfo.move_2}`))),o(6),l(n(57,49,"teamBuilder.move3")),o(4),l(n(62,53,n(61,51,`moves.name.${e.teamInfo.move_3}`))),o(6),l(n(67,55,"teamBuilder.move4")),o(4),l(n(72,59,n(71,57,`moves.name.${e.teamInfo.move_4}`))),o(3),A("routerLink","/pokemonFrm/",t.aTeams[0].id,"/",e.teamInfo.id,"")}}function _e(d,m){d&1&&(s(0,"p",6),p(1),a(2,"translate"),r()),d&2&&(o(),l(n(2,1,"teamBuilder.emptyTeam")))}var ne=class d{constructor(m){this.dialog=m}userId;teamId;aTeams=[];aPokemonTeamIds=[];aPokemonTeamInfo=[];aPokemonData=[];aFullPokemonTeam=[];aExport=[];router=v(q);activatedRoute=v(L);serviceTeams=v(O);servicePokemonTeam=v(K);servicePokemonData=v(Q);serviceAbilities=v(X);serviceTypes=v(te);serviceItems=v(W);serviceMoves=v(Y);ngOnInit(){this.activatedRoute.paramMap.subscribe(m=>{this.userId=parseInt(m.get("userId")),this.teamId=parseInt(m.get("teamId"))}),this.obtainTeamInfo()}obtainTeamInfo(){this.serviceTeams.getTeam(this.teamId).subscribe({next:m=>{this.aTeams=m;for(let e of this.aTeams)for(let t=1;t<=6;t++){let i=`pokemon_${t}`,k=e[i];k!=null&&this.aPokemonTeamIds.push(k)}this.obtainPokemonTeamInfo()},error:m=>{console.log(m)}})}obtainPokemonTeamInfo(){let m=this.aPokemonTeamIds.map(e=>this.servicePokemonTeam.getPokemonTeamId(e));b(m).subscribe({next:e=>{this.aPokemonTeamInfo=e.map(t=>Array.isArray(t)&&t.length>0?t[0]:null).filter(t=>t!==null),this.obtainPokemonData()},error:e=>{console.error("Error fetching team data:",e)}})}obtainPokemonData(){let m=this.aPokemonTeamInfo.map(t=>this.servicePokemonData.getPokemonDataFromTeam(t.id_pokemon)),e=this.aPokemonTeamInfo.map(t=>this.serviceTypes.getType(t.tera_type));b([b(m),b(e)]).subscribe({next:([t,i])=>{let k=t.map(c=>Array.isArray(c)&&c.length>0?c[0]:null),I=i.map((c,_)=>{if(Array.isArray(c)&&c.length>0)return c[0]});for(let c=0;c<this.aPokemonTeamInfo.length;c++){let _=this.aPokemonTeamInfo[c],B=k[c],P=I[c];_&&B&&this.aFullPokemonTeam.push({teamInfo:_,baseData:B,teraTypeImage:P.image_small})}console.log("Full Pok\xE9mon team data with teraType images:",this.aFullPokemonTeam)},error:t=>{console.error("Error fetching Pok\xE9mon or Tera Type data:",t)}})}addPokemon(){this.router.navigateByUrl(`/pokemonFrm/${this.teamId}`)}editTeam(){this.dialog.open(G,{data:{name:this.aTeams[0].name,description:this.aTeams[0].description}}).afterClosed().subscribe(e=>{if(e){let t={id:this.aTeams[0].id,name:e.name,description:e.description,user_id:this.aTeams[0].user_id,pokemon_1:this.aTeams[0].pokemon_1,pokemon_2:this.aTeams[0].pokemon_2,pokemon_3:this.aTeams[0].pokemon_3,pokemon_4:this.aTeams[0].pokemon_4,pokemon_5:this.aTeams[0].pokemon_5,pokemon_6:this.aTeams[0].pokemon_6};this.serviceTeams.updatePokemonTeam(t).subscribe({next:i=>{oe.default.fire("The team has been updated","","success"),this.router.navigateByUrl("/teamManager")},error:i=>{console.log(i)}})}})}exportTeam(){return D(this,null,function*(){yield this.generateShowdownTeam(this.aFullPokemonTeam);let m=this.dialog.open(ae,{data:this.aExport});this.aExport=[]})}generateShowdownTeam=m=>D(this,null,function*(){for(let e=0;e<m.length;e++){let t=m[e].baseData,i=m[e].teamInfo,I=(yield f(this.serviceAbilities.getAbility(i.ability)))[0].name_en,_=(yield f(this.serviceItems.getItem(i.item)))[0].name_en,P=(yield f(this.serviceTypes.getType(i.tera_type)))[0].name_en,me=(yield f(this.serviceMoves.getMove(i.move_1)))[0].name_en,re=(yield f(this.serviceMoves.getMove(i.move_2)))[0].name_en,se=(yield f(this.serviceMoves.getMove(i.move_3)))[0].name_en,pe=(yield f(this.serviceMoves.getMove(i.move_4)))[0].name_en,le=[{stat:"HP",value:i.ev_hp},{stat:"Atk",value:i.ev_atk},{stat:"Def",value:i.ev_def},{stat:"SpA",value:i.ev_spatk},{stat:"SpD",value:i.ev_spdef},{stat:"Spe",value:i.ev_spd}].filter(u=>u.value>0),de=[{stat:"HP",value:i.iv_hp},{stat:"Atk",value:i.iv_atk},{stat:"Def",value:i.iv_def},{stat:"SpA",value:i.iv_spatk},{stat:"SpD",value:i.iv_spdef},{stat:"Spe",value:i.iv_spd}].filter(u=>u.value<31),ce=`${t.name_en} @ ${_}
Ability: ${I}
Tera Type: ${P}
Level: ${i.level}
EVs: ${le.map(u=>`${u.value} ${u.stat}`).join(" / ")}
IVs: ${de.map(u=>`${u.value} ${u.stat}`).join(" / ")}
- ${me}
- ${re}
- ${se}
- ${pe}

`;this.aExport.push(ce)}});static \u0275fac=function(e){return new(e||d)(S(J))};static \u0275cmp=E({type:d,selectors:[["app-team-builder"]],decls:21,vars:13,consts:[[1,"row"],[1,"col-12","mt-3","d-flex","flex-column","justify-content-between"],[1,"col-12"],[1,"btn","btn-success","mx-2",3,"click","disabled"],[1,"btn","btn-success","mx-2",3,"click"],[1,"border","my-2","shadow-sm",3,"ngStyle"],[1,"text-center"],[1,"col-12","col-lg-2","text-center","my-2"],[1,"img-fluid","mx-auto","d-block",3,"src"],[1,"d-inline-flex","justify-content-center","align-items-center"],[1,"img-fluid","d-block",2,"width","30px","height","30px",3,"src"],[1,"col-4","col-lg-4","my-2"],[1,"form-group","text-center"],["id","ability","disabled","",1,"form-select"],["selected",""],["id","item","disabled","",1,"form-select"],[1,"col-8","col-lg-6","my-2"],[1,"col-6"],["id","move1","disabled","",1,"form-select"],["id","move2","disabled","",1,"form-select"],["id","move4","disabled","",1,"form-select"],[1,"stretched-link",3,"routerLink"]],template:function(e,t){e&1&&(s(0,"div",0)(1,"div",1)(2,"h2"),p(3),r(),s(4,"span"),p(5),r()()(),h(6,"hr"),s(7,"div",0)(8,"div",2)(9,"button",3),y("click",function(){return t.addPokemon()}),p(10),a(11,"translate"),r(),s(12,"button",4),y("click",function(){return t.editTeam()}),p(13),a(14,"translate"),r(),s(15,"button",4),y("click",function(){return t.exportTeam()}),p(16),a(17,"translate"),r(),M(18,ke,74,62,"div",5,w,!1,_e,3,3,"p",6),r()()),e&2&&(o(3),l(t.aTeams[0].name),o(2),l(t.aTeams[0].description),o(4),T("disabled",t.aFullPokemonTeam.length>=6),o(),l(n(11,7,"teamBuilder.add")),o(3),l(n(14,9,"teamBuilder.edit")),o(3),l(n(17,11,"teamBuilder.export")),o(2),F(t.aFullPokemonTeam))},dependencies:[U,R,j,Z,ee,ie,H,V,z],encapsulation:2})};export{ne as TeamBuilderComponent};
