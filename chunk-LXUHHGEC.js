import{a as L}from"./chunk-4JKD2TZL.js";import{a as ie}from"./chunk-DKZG7MX5.js";import{c as J}from"./chunk-R2BWZGB6.js";import{a as G,b as Y,c as Z,d as te}from"./chunk-754JF3G2.js";import{a as ee}from"./chunk-7DJ5TZZF.js";import{a as Q}from"./chunk-TPB2NVBM.js";import{a as K}from"./chunk-LLZLNGRP.js";import{a as X}from"./chunk-JTSZS4GU.js";import{a as W}from"./chunk-DOSSN5ZZ.js";import"./chunk-SGYCFQGT.js";import"./chunk-LTCMITUI.js";import{a as O}from"./chunk-OGBFUU3Y.js";import"./chunk-F6IFWQ6I.js";import"./chunk-PUI4IBEA.js";import"./chunk-J6MKEWI4.js";import{a as ve}from"./chunk-MEC76M2Q.js";import"./chunk-IWXTRJGV.js";import{Cb as R,Da as T,Fb as j,Gb as U,Ha as C,Ia as w,Ja as F,Ka as M,La as s,Ma as r,Na as h,P as v,Pb as q,Qa as y,Ra as x,Rb as z,Va as A,Xb as V,Yb as H,bb as p,cb as l,e as ce,f as D,jb as N,ka as g,la as m,lb as a,mb as n,o as f,pa as S,t as b,ta as E,za as $}from"./chunk-FKC2K5KC.js";var ne=ce(ve());var ue=()=>({position:"relative"});function fe(d,o){if(d&1&&(h(0,"img",8),a(1,"pokemonShinyPath")),d&2){let e=x().$implicit;T("src",n(1,1,e.baseData.image_shiny),g)}}function Te(d,o){if(d&1&&(h(0,"img",8),a(1,"pokemonPath")),d&2){let e=x().$implicit;T("src",n(1,1,e.baseData.image),g)}}function he(d,o){if(d&1&&(s(0,"div",5)(1,"div",0)(2,"div",7),$(3,fe,2,3,"img",8)(4,Te,2,3,"img",8),s(5,"div",9)(6,"span"),p(7),a(8,"translate"),a(9,"titlecase"),r(),h(10,"img",10),a(11,"typePath"),r()(),s(12,"div",11)(13,"div",12)(14,"small"),p(15),a(16,"translate"),r(),s(17,"select",13)(18,"option",14),p(19),a(20,"translate"),a(21,"titlecase"),r()()(),s(22,"div",12)(23,"small"),p(24),a(25,"translate"),r(),s(26,"select",15)(27,"option",14),p(28),a(29,"translate"),a(30,"titlecase"),r()()()(),s(31,"div",16)(32,"div",0)(33,"div",17)(34,"div",12)(35,"small"),p(36),a(37,"translate"),r(),s(38,"select",18)(39,"option",14),p(40),a(41,"translate"),a(42,"titlecase"),r()()()(),s(43,"div",17)(44,"div",12)(45,"small"),p(46),a(47,"translate"),r(),s(48,"select",19)(49,"option",14),p(50),a(51,"translate"),a(52,"titlecase"),r()()()(),s(53,"div",17)(54,"div",12)(55,"small"),p(56),a(57,"translate"),r(),s(58,"select",20)(59,"option",14),p(60),a(61,"translate"),a(62,"titlecase"),r()()()(),s(63,"div",17)(64,"div",12)(65,"small"),p(66),a(67,"translate"),r(),s(68,"select",20)(69,"option",14),p(70),a(71,"translate"),a(72,"titlecase"),r()()()()()()(),h(73,"a",21),r()),d&2){let e=o.$implicit,t=x();T("ngStyle",N(61,ue)),m(3),C(e.teamInfo.is_shiny?3:4),m(4),l(n(9,21,n(8,19,`pokemonData.name.${e.baseData.id}`))),m(3),T("src",n(11,23,e.teraTypeImage),g),m(5),l(n(16,25,"teamBuilder.ability")),m(4),l(n(21,29,n(20,27,`abilities.name.${e.teamInfo.ability}`))),m(5),l(n(25,31,"teamBuilder.item")),m(4),l(n(30,35,n(29,33,`items.name.${e.teamInfo.item}`))),m(8),l(n(37,37,"teamBuilder.move1")),m(4),l(n(42,41,n(41,39,`moves.name.${e.teamInfo.move_1}`))),m(6),l(n(47,43,"teamBuilder.move2")),m(4),l(n(52,47,n(51,45,`moves.name.${e.teamInfo.move_2}`))),m(6),l(n(57,49,"teamBuilder.move3")),m(4),l(n(62,53,n(61,51,`moves.name.${e.teamInfo.move_3}`))),m(6),l(n(67,55,"teamBuilder.move4")),m(4),l(n(72,59,n(71,57,`moves.name.${e.teamInfo.move_4}`))),m(3),A("href","/pokemonFrm/",t.aTeams[0].id,"/",e.teamInfo.id,"",g)}}function _e(d,o){d&1&&(s(0,"p",6),p(1),a(2,"translate"),r()),d&2&&(m(),l(n(2,1,"teamBuilder.emptyTeam")))}var ae=class d{constructor(o){this.dialog=o}userId;teamId;aTeams=[];aPokemonTeamIds=[];aPokemonTeamInfo=[];aPokemonData=[];aFullPokemonTeam=[];aExport=[];router=v(z);activatedRoute=v(q);serviceTeams=v(O);servicePokemonTeam=v(G);servicePokemonData=v(K);serviceAbilities=v(W);serviceTypes=v(ee);serviceItems=v(Q);serviceMoves=v(X);ngOnInit(){this.activatedRoute.paramMap.subscribe(o=>{this.userId=parseInt(o.get("userId")),this.teamId=parseInt(o.get("teamId"))}),this.obtainTeamInfo()}obtainTeamInfo(){this.serviceTeams.getTeam(this.teamId).subscribe({next:o=>{this.aTeams=o;for(let e of this.aTeams)for(let t=1;t<=6;t++){let i=`pokemon_${t}`,_=e[i];_!=null&&this.aPokemonTeamIds.push(_)}this.obtainPokemonTeamInfo()},error:o=>{console.log(o)}})}obtainPokemonTeamInfo(){let o=this.aPokemonTeamIds.map(e=>this.servicePokemonTeam.getPokemonTeamId(e));b(o).subscribe({next:e=>{this.aPokemonTeamInfo=e.map(t=>Array.isArray(t)&&t.length>0?t[0]:null).filter(t=>t!==null),this.obtainPokemonData()},error:e=>{console.error("Error fetching team data:",e)}})}obtainPokemonData(){let o=this.aPokemonTeamInfo.map(t=>this.servicePokemonData.getPokemonDataFromTeam(t.id_pokemon)),e=this.aPokemonTeamInfo.map(t=>this.serviceTypes.getType(t.tera_type));b([b(o),b(e)]).subscribe({next:([t,i])=>{let _=t.map(c=>Array.isArray(c)&&c.length>0?c[0]:null),I=i.map((c,k)=>{if(Array.isArray(c)&&c.length>0)return c[0]});for(let c=0;c<this.aPokemonTeamInfo.length;c++){let k=this.aPokemonTeamInfo[c],P=_[c],B=I[c];k&&P&&this.aFullPokemonTeam.push({teamInfo:k,baseData:P,teraTypeImage:B.image_small})}console.log("Full Pok\xE9mon team data with teraType images:",this.aFullPokemonTeam)},error:t=>{console.error("Error fetching Pok\xE9mon or Tera Type data:",t)}})}addPokemon(){this.router.navigateByUrl(`/pokemonFrm/${this.teamId}`)}editTeam(){this.dialog.open(L,{data:{name:this.aTeams[0].name,description:this.aTeams[0].description}}).afterClosed().subscribe(e=>{if(e){let t={id:this.aTeams[0].id,name:e.name,description:e.description,user_id:this.aTeams[0].user_id,pokemon_1:this.aTeams[0].pokemon_1,pokemon_2:this.aTeams[0].pokemon_2,pokemon_3:this.aTeams[0].pokemon_3,pokemon_4:this.aTeams[0].pokemon_4,pokemon_5:this.aTeams[0].pokemon_5,pokemon_6:this.aTeams[0].pokemon_6};this.serviceTeams.updatePokemonTeam(t).subscribe({next:i=>{ne.default.fire("The team has been updated","","success"),this.router.navigate([this.router.url])},error:i=>{console.log(i)}})}})}exportTeam(){return D(this,null,function*(){yield this.generateShowdownTeam(this.aFullPokemonTeam);let o=this.dialog.open(ie,{data:this.aExport});this.aExport=[]})}generateShowdownTeam=o=>D(this,null,function*(){console.log("fullPokemonTeamData que el metodo generateShowdownTeam recibe:",o);for(let e=0;e<o.length;e++){let t=o[e].baseData,i=o[e].teamInfo,I=(yield f(this.serviceAbilities.getAbility(i.ability)))[0].name_en,k=(yield f(this.serviceItems.getItem(i.item)))[0].name_en,B=(yield f(this.serviceTypes.getType(i.tera_type)))[0].name_en,oe=(yield f(this.serviceMoves.getMove(i.move_1)))[0].name_en,me=(yield f(this.serviceMoves.getMove(i.move_2)))[0].name_en,re=(yield f(this.serviceMoves.getMove(i.move_3)))[0].name_en,se=(yield f(this.serviceMoves.getMove(i.move_4)))[0].name_en,pe=[{stat:"HP",value:i.ev_hp},{stat:"Atk",value:i.ev_atk},{stat:"Def",value:i.ev_def},{stat:"SpA",value:i.ev_spatk},{stat:"SpD",value:i.ev_spdef},{stat:"Spe",value:i.ev_spd}].filter(u=>u.value>0),le=[{stat:"HP",value:i.iv_hp},{stat:"Atk",value:i.iv_atk},{stat:"Def",value:i.iv_def},{stat:"SpA",value:i.iv_spatk},{stat:"SpD",value:i.iv_spdef},{stat:"Spe",value:i.iv_spd}].filter(u=>u.value<31),de=`${t.name_en} @ ${k}
Ability: ${I}
Tera Type: ${B}
Level: ${i.level}
EVs: ${pe.map(u=>`${u.value} ${u.stat}`).join(" / ")}
IVs: ${le.map(u=>`${u.value} ${u.stat}`).join(" / ")}
- ${oe}
- ${me}
- ${re}
- ${se}

`;this.aExport.push(de)}});static \u0275fac=function(e){return new(e||d)(S(J))};static \u0275cmp=E({type:d,selectors:[["app-team-builder"]],decls:21,vars:13,consts:[[1,"row"],[1,"col-12","mt-3","d-flex","flex-column","justify-content-between"],[1,"col-12"],[1,"btn","btn-success","mx-2",3,"click","disabled"],[1,"btn","btn-success","mx-2",3,"click"],[1,"border","my-2","shadow-sm",3,"ngStyle"],[1,"text-center"],[1,"col-12","col-lg-2","text-center","my-2"],[1,"img-fluid","mx-auto","d-block",3,"src"],[1,"d-inline-flex","justify-content-center","align-items-center"],[1,"img-fluid","d-block",2,"width","30px","height","30px",3,"src"],[1,"col-4","col-lg-4","my-2"],[1,"form-group","text-center"],["id","ability","disabled","",1,"form-select"],["selected",""],["id","item","disabled","",1,"form-select"],[1,"col-8","col-lg-6","my-2"],[1,"col-6"],["id","move1","disabled","",1,"form-select"],["id","move2","disabled","",1,"form-select"],["id","move4","disabled","",1,"form-select"],[1,"stretched-link",3,"href"]],template:function(e,t){e&1&&(s(0,"div",0)(1,"div",1)(2,"h2"),p(3),r(),s(4,"span"),p(5),r()()(),h(6,"hr"),s(7,"div",0)(8,"div",2)(9,"button",3),y("click",function(){return t.addPokemon()}),p(10),a(11,"translate"),r(),s(12,"button",4),y("click",function(){return t.editTeam()}),p(13),a(14,"translate"),r(),s(15,"button",4),y("click",function(){return t.exportTeam()}),p(16),a(17,"translate"),r(),F(18,he,74,62,"div",5,w,!1,_e,3,3,"p",6),r()()),e&2&&(m(3),l(t.aTeams[0].name),m(2),l(t.aTeams[0].description),m(4),T("disabled",t.aFullPokemonTeam.length>=6),m(),l(n(11,7,"teamBuilder.add")),m(3),l(n(14,9,"teamBuilder.edit")),m(3),l(n(17,11,"teamBuilder.export")),m(2),M(t.aFullPokemonTeam))},dependencies:[U,R,j,Y,Z,te,H,V],encapsulation:2})};export{ae as TeamBuilderComponent};
