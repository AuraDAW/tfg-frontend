import{a as ae}from"./chunk-BYU4ZZDF.js";import{c as G}from"./chunk-R2BWZGB6.js";import{a as K,b as Z,c as ee,d as ie}from"./chunk-GPMS4MJC.js";import{a as te}from"./chunk-KSL4GJU4.js";import{a as W}from"./chunk-PSDVRDZ2.js";import{a as Q}from"./chunk-2DCUL4N3.js";import{a as Y}from"./chunk-A6I5M2ZJ.js";import{a as X}from"./chunk-TXDXGVCW.js";import"./chunk-SGYCFQGT.js";import"./chunk-LTCMITUI.js";import{a as O}from"./chunk-ZAWSE2MG.js";import{a as J}from"./chunk-OZRWMOLO.js";import"./chunk-F6IFWQ6I.js";import"./chunk-PUI4IBEA.js";import"./chunk-J6MKEWI4.js";import{a as fe}from"./chunk-MEC76M2Q.js";import"./chunk-3CD6P3UR.js";import{Bb as R,Da as x,Fb as j,Gb as q,Ha as A,Ia as F,Ja as M,Ka as V,La as r,Ma as s,Na as _,Oa as N,P as d,Pb as z,Qa as B,Ra as g,Rb as U,T as w,U as E,Xb as H,Yb as L,bb as p,cb as l,e as de,f as P,ka as I,la as m,lb as n,mb as o,o as u,pa as $,t as b,ta as C,za as S}from"./chunk-FKC2K5KC.js";var oe=de(fe());function ue(c,t){if(c&1){let e=N();r(0,"button",4),B("click",function(){w(e);let i=g();return E(i.favoriteTeam())}),p(1),s()}if(c&2){let e=g();m(),l(e.isFavoritedTeam?"Remove Favorite":"Add Favorite")}}function Te(c,t){if(c&1&&(_(0,"img",8),n(1,"pokemonShinyPath")),c&2){let e=g().$implicit;x("src",o(1,1,e.baseData.image_shiny),I)}}function he(c,t){if(c&1&&(_(0,"img",8),n(1,"pokemonPath")),c&2){let e=g().$implicit;x("src",o(1,1,e.baseData.image),I)}}function be(c,t){if(c&1&&(r(0,"div",5)(1,"div",0)(2,"div",7),S(3,Te,2,3,"img",8)(4,he,2,3,"img",8),r(5,"div",9)(6,"option",10),p(7),n(8,"translate"),n(9,"titlecase"),s(),_(10,"img",11),n(11,"typePath"),s()(),r(12,"div",12)(13,"div",13)(14,"small"),p(15),n(16,"translate"),s(),r(17,"select",14)(18,"option",10),p(19),n(20,"translate"),n(21,"titlecase"),s()()(),r(22,"div",13)(23,"small"),p(24),n(25,"translate"),s(),r(26,"select",15)(27,"option",10),p(28),n(29,"translate"),n(30,"titlecase"),s()()()(),r(31,"div",16)(32,"div",0)(33,"div",17)(34,"div",13)(35,"small"),p(36),n(37,"translate"),s(),r(38,"select",18)(39,"option",10),p(40),n(41,"translate"),n(42,"titlecase"),s()()()(),r(43,"div",17)(44,"div",13)(45,"small"),p(46),n(47,"translate"),s(),r(48,"select",19)(49,"option",10),p(50),n(51,"translate"),n(52,"titlecase"),s()()()(),r(53,"div",17)(54,"div",13)(55,"small"),p(56),n(57,"translate"),s(),r(58,"select",20)(59,"option",10),p(60),n(61,"translate"),n(62,"titlecase"),s()()()(),r(63,"div",17)(64,"div",13)(65,"small"),p(66),n(67,"translate"),s(),r(68,"select",20)(69,"option",10),p(70),n(71,"translate"),n(72,"titlecase"),s()()()()()()()()),c&2){let e=t.$implicit;m(3),A(e.teamInfo.is_shiny?3:4),m(4),l(o(9,17,o(8,15,`pokemonData.name.${e.baseData.id}`))),m(3),x("src",o(11,19,e.teraTypeImage),I),m(5),l(o(16,21,"teamBuilder.ability")),m(4),l(o(21,25,o(20,23,`abilities.name.${e.teamInfo.ability}`))),m(5),l(o(25,27,"teamBuilder.item")),m(4),l(o(30,31,o(29,29,`items.name.${e.teamInfo.item}`))),m(8),l(o(37,33,"teamBuilder.move1")),m(4),l(o(42,37,o(41,35,`moves.name.${e.teamInfo.move_1}`))),m(6),l(o(47,39,"teamBuilder.move2")),m(4),l(o(52,43,o(51,41,`moves.name.${e.teamInfo.move_2}`))),m(6),l(o(57,45,"teamBuilder.move3")),m(4),l(o(62,49,o(61,47,`moves.name.${e.teamInfo.move_3}`))),m(6),l(o(67,51,"teamBuilder.move4")),m(4),l(o(72,55,o(71,53,`moves.name.${e.teamInfo.move_4}`)))}}function xe(c,t){c&1&&(r(0,"p",6),p(1),n(2,"translate"),s()),c&2&&(m(),l(o(2,1,"teamBuilder.emptyTeam")))}var ne=class c{constructor(t){this.dialog=t}teamId;role;isFavoritedTeam=!1;aTeams=[];aPokemonTeamIds=[];aPokemonTeamInfo=[];aPokemonData=[];aFullPokemonTeam=[];aExport=[];router=d(U);activatedRoute=d(z);serviceTeams=d(O);servicePokemonTeam=d(K);servicePokemonData=d(Q);serviceAbilities=d(X);serviceTypes=d(te);serviceItems=d(W);serviceMoves=d(Y);serviceAuth=d(J);ngOnInit(){this.activatedRoute.paramMap.subscribe(t=>{this.teamId=parseInt(t.get("teamId"))}),this.obtainTeamInfo(),this.serviceAuth.isLoggedIn()&&(this.role=this.serviceAuth.getRoleFromToken()),this.serviceTeams.isFavorited(this.teamId).subscribe(t=>{this.isFavoritedTeam=t})}obtainTeamInfo(){this.serviceTeams.getTeam(this.teamId).subscribe({next:t=>{this.aTeams=t;for(let e of this.aTeams)for(let a=1;a<=6;a++){let i=`pokemon_${a}`,T=e[i];T!=null&&this.aPokemonTeamIds.push(T)}this.obtainPokemonTeamInfo()},error:t=>{console.log(t)}})}obtainPokemonTeamInfo(){let t=this.aPokemonTeamIds.map(e=>this.servicePokemonTeam.getPokemonTeamId(e));b(t).subscribe({next:e=>{this.aPokemonTeamInfo=e.map(a=>Array.isArray(a)&&a.length>0?a[0]:null).filter(a=>a!==null),this.obtainPokemonData()},error:e=>{console.error("Error fetching team data:",e)}})}obtainPokemonData(){let t=this.aPokemonTeamInfo.map(a=>this.servicePokemonData.getPokemonDataFromTeam(a.id_pokemon)),e=this.aPokemonTeamInfo.map(a=>this.serviceTypes.getType(a.tera_type));b([b(t),b(e)]).subscribe({next:([a,i])=>{let T=a.map(v=>Array.isArray(v)&&v.length>0?v[0]:null),y=i.map((v,h)=>{if(Array.isArray(v)&&v.length>0)return v[0]});for(let v=0;v<this.aPokemonTeamInfo.length;v++){let h=this.aPokemonTeamInfo[v],k=T[v],D=y[v];h&&k&&this.aFullPokemonTeam.push({teamInfo:h,baseData:k,teraTypeImage:D.image_small})}},error:a=>{console.error("Error fetching Pok\xE9mon or Tera Type data:",a)}})}favoriteTeam(){this.serviceTeams.favoriteTeam(this.teamId).subscribe({next:t=>{let e=t.message==="added"?"The team has been marked as favorite":"The team has been removed from favorites";t.message==="added"?this.isFavoritedTeam=!0:this.isFavoritedTeam=!1,oe.default.fire(e,"","success")},error:t=>{console.log(t)}})}exportTeam(){return P(this,null,function*(){yield this.generateShowdownTeam(this.aFullPokemonTeam);let t=this.dialog.open(ae,{data:this.aExport});this.aExport=[]})}generateShowdownTeam=t=>P(this,null,function*(){for(let e=0;e<t.length;e++){let a=t[e].baseData,i=t[e].teamInfo,y=(yield u(this.serviceAbilities.getAbility(i.ability)))[0].name_en,h=(yield u(this.serviceItems.getItem(i.item)))[0].name_en,D=(yield u(this.serviceTypes.getType(i.tera_type)))[0].name_en,me=(yield u(this.serviceMoves.getMove(i.move_1)))[0].name_en,re=(yield u(this.serviceMoves.getMove(i.move_2)))[0].name_en,se=(yield u(this.serviceMoves.getMove(i.move_3)))[0].name_en,pe=(yield u(this.serviceMoves.getMove(i.move_4)))[0].name_en,le=[{stat:"HP",value:i.ev_hp},{stat:"Atk",value:i.ev_atk},{stat:"Def",value:i.ev_def},{stat:"SpA",value:i.ev_spatk},{stat:"SpD",value:i.ev_spdef},{stat:"Spe",value:i.ev_spd}].filter(f=>f.value>0),ce=[{stat:"HP",value:i.iv_hp},{stat:"Atk",value:i.iv_atk},{stat:"Def",value:i.iv_def},{stat:"SpA",value:i.iv_spatk},{stat:"SpD",value:i.iv_spdef},{stat:"Spe",value:i.iv_spd}].filter(f=>f.value<31),ve=`${a.name_en} @ ${h}
Ability: ${y}
Tera Type: ${D}
Level: ${i.level}
EVs: ${le.map(f=>`${f.value} ${f.stat}`).join(" / ")}
IVs: ${ce.map(f=>`${f.value} ${f.stat}`).join(" / ")}
- ${me}
- ${re}
- ${se}
- ${pe}

`;this.aExport.push(ve)}});static \u0275fac=function(e){return new(e||c)($(G))};static \u0275cmp=C({type:c,selectors:[["app-team-viewer"]],decls:16,vars:7,consts:[[1,"row"],[1,"col-12","mt-3","d-flex","flex-column","justify-content-between"],[1,"col-12"],["class","btn btn-success mx-2",3,"click",4,"ngIf"],[1,"btn","btn-success","mx-2",3,"click"],[1,"border","my-2","shadow-sm"],[1,"text-center"],[1,"col-12","col-lg-2","text-center","my-2"],[1,"img-fluid","mx-auto","d-block",3,"src"],[1,"d-inline-flex","justify-content-center","align-items-center"],["selected",""],[1,"img-fluid","d-block",2,"width","30px","height","30px",3,"src"],[1,"col-4","col-lg-4","my-2"],[1,"form-group","text-center"],["id","ability","disabled","",1,"form-select"],["id","item","disabled","",1,"form-select"],[1,"col-8","col-lg-6","my-2"],[1,"col-6"],["id","move1","disabled","",1,"form-select"],["id","move2","disabled","",1,"form-select"],["id","move4","disabled","",1,"form-select"]],template:function(e,a){e&1&&(r(0,"div",0)(1,"div",1)(2,"h2"),p(3),s(),r(4,"span"),p(5),s()()(),_(6,"hr"),r(7,"div",0)(8,"div",2),S(9,ue,2,1,"button",3),r(10,"button",4),B("click",function(){return a.exportTeam()}),p(11),n(12,"translate"),s(),M(13,be,73,57,"div",5,F,!1,xe,3,3,"p",6),s()()),e&2&&(m(3),l(a.aTeams[0].name),m(2),l(a.aTeams[0].description),m(4),x("ngIf",a.role==2),m(2),l(o(12,5,"teamBuilder.export")),m(2),V(a.aFullPokemonTeam))},dependencies:[q,R,j,Z,ee,ie,L,H],encapsulation:2})};export{ne as TeamViewerComponent};
